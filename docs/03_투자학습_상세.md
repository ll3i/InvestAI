# 📚 Pixie 투자 학습 페이지 개발 문서

## 🎯 페이지 개요

### 목적
투자 초보자부터 중급자까지 단계별로 투자 지식을 습득할 수 있는 종합적인 학습 플랫폼입니다.

### 주요 기능
- 단계별 투자 교육 과정
- 인터랙티브 퀴즈 시스템
- 실시간 학습 진도 추적
- 개인화된 학습 경로
- 카드뉴스 형태의 시각적 학습

## 🏗️ 기술적 아키텍처

### 프론트엔드 구조
```
web/templates/
├── learning.html              # 메인 학습 페이지
├── learning_quiz.html         # 퀴즈 페이지
├── learning_cardnews.html     # 카드뉴스 페이지
├── learning_terms.html        # 용어 사전 페이지
└── learning_progress.html     # 학습 진도 페이지
```

### 백엔드 구조
```
web/
├── app.py                     # 학습 관련 라우트
├── blueprints/
│   └── learning/             # 학습 관련 라우트
└── services/
    ├── learning_service.py    # 학습 콘텐츠 관리
    ├── quiz_service.py        # 퀴즈 시스템
    └── progress_service.py    # 진도 추적 서비스
```

## 📱 UI/UX 설계

### 학습 과정 구조
1. **기초 과정**
   - 투자 기본 개념
   - 주식 시장 이해
   - 위험 관리 기초

2. **중급 과정**
   - 기술적 분석
   - 기본적 분석
   - 포트폴리오 구성

3. **고급 과정**
   - 파생상품 이해
   - 글로벌 투자
   - 고급 전략

### 학습 모듈 구성
```javascript
// web/static/js/learning.js
class LearningManager {
    constructor() {
        this.currentModule = 0;
        this.userProgress = {};
        this.init();
    }
    
    init() {
        this.loadUserProgress();
        this.displayCurrentModule();
        this.setupEventListeners();
    }
    
    loadUserProgress() {
        fetch('/api/learning/progress')
            .then(response => response.json())
            .then(data => {
                this.userProgress = data;
                this.updateProgressUI();
            });
    }
    
    displayCurrentModule() {
        const module = this.getCurrentModule();
        if (!module) return;
        
        const container = document.getElementById('learning-content');
        container.innerHTML = this.generateModuleHTML(module);
        
        this.setupModuleInteractions();
    }
    
    generateModuleHTML(module) {
        return `
            <div class="module-container">
                <div class="module-header">
                    <h2>${module.title}</h2>
                    <div class="module-progress">
                        <span class="progress-text">${module.completed}/${module.total} 완료</span>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${(module.completed/module.total)*100}%"></div>
                        </div>
                    </div>
                </div>
                
                <div class="module-content">
                    ${this.generateContentHTML(module.content)}
                </div>
                
                <div class="module-navigation">
                    <button class="btn btn-secondary" onclick="learningManager.previousModule()">이전</button>
                    <button class="btn btn-primary" onclick="learningManager.nextModule()">다음</button>
                </div>
            </div>
        `;
    }
}
```

## 🔧 핵심 기능 구현

### 1. 학습 콘텐츠 관리
```python
# web/services/learning_service.py
class LearningService:
    def __init__(self):
        self.modules = self.load_learning_modules()
        self.user_progress = {}
    
    def load_learning_modules(self) -> List[Dict[str, Any]]:
        """학습 모듈 로드"""
        return [
            {
                'id': 1,
                'title': '투자 기초 개념',
                'level': 'beginner',
                'duration': 30,  # 분
                'lessons': [
                    {
                        'id': 1,
                        'title': '투자란 무엇인가?',
                        'content': self.load_lesson_content(1),
                        'quiz_id': 1
                    },
                    {
                        'id': 2,
                        'title': '주식과 채권의 차이',
                        'content': self.load_lesson_content(2),
                        'quiz_id': 2
                    }
                ]
            },
            {
                'id': 2,
                'title': '주식 시장 이해',
                'level': 'beginner',
                'duration': 45,
                'lessons': [
                    {
                        'id': 3,
                        'title': 'KOSPI와 KOSDAQ',
                        'content': self.load_lesson_content(3),
                        'quiz_id': 3
                    }
                ]
            }
        ]
    
    def get_user_progress(self, user_id: str) -> Dict[str, Any]:
        """사용자 학습 진도 조회"""
        try:
            progress = self.query_user_progress(user_id)
            
            # 각 모듈별 완료율 계산
            for module in self.modules:
                completed_lessons = len([p for p in progress if p['module_id'] == module['id'] and p['completed']])
                module['completed'] = completed_lessons
                module['total'] = len(module['lessons'])
                module['progress_rate'] = (completed_lessons / len(module['lessons'])) * 100
            
            return {
                'modules': self.modules,
                'overall_progress': self.calculate_overall_progress(progress),
                'current_module': self.get_current_module(user_id, progress)
            }
        except Exception as e:
            logger.error(f"학습 진도 조회 실패: {e}")
            return {}
    
    def mark_lesson_completed(self, user_id: str, lesson_id: int) -> bool:
        """강의 완료 표시"""
        try:
            # 데이터베이스에 완료 기록
            self.save_lesson_completion(user_id, lesson_id)
            
            # 진도 업데이트
            self.update_user_progress(user_id, lesson_id)
            
            return True
        except Exception as e:
            logger.error(f"강의 완료 표시 실패: {e}")
            return False
```

### 2. 퀴즈 시스템
```python
# web/services/quiz_service.py
class QuizService:
    def __init__(self):
        self.quizzes = self.load_quizzes()
    
    def load_quizzes(self) -> List[Dict[str, Any]]:
        """퀴즈 데이터 로드"""
        return [
            {
                'id': 1,
                'lesson_id': 1,
                'title': '투자 기초 퀴즈',
                'questions': [
                    {
                        'id': 1,
                        'question': '투자의 목적은 무엇인가요?',
                        'options': [
                            '즉시 소비하기',
                            '미래의 수익을 위해 자산을 운용하기',
                            '즉시 지출하기',
                            '현금 보관하기'
                        ],
                        'correct_answer': 1,
                        'explanation': '투자는 현재의 자산을 미래의 더 큰 수익을 위해 운용하는 행위입니다.'
                    }
                ]
            }
        ]
    
    def get_quiz_by_lesson(self, lesson_id: int) -> Optional[Dict[str, Any]]:
        """강의별 퀴즈 조회"""
        return next((q for q in self.quizzes if q['lesson_id'] == lesson_id), None)
    
    def grade_quiz(self, quiz_id: int, answers: List[int]) -> Dict[str, Any]:
        """퀴즈 채점"""
        try:
            quiz = next((q for q in self.quizzes if q['id'] == quiz_id), None)
            if not quiz:
                return {'error': '퀴즈를 찾을 수 없습니다.'}
            
            correct_count = 0
            results = []
            
            for i, question in enumerate(quiz['questions']):
                user_answer = answers[i] if i < len(answers) else None
                is_correct = user_answer == question['correct_answer']
                
                if is_correct:
                    correct_count += 1
                
                results.append({
                    'question_id': question['id'],
                    'user_answer': user_answer,
                    'correct_answer': question['correct_answer'],
                    'is_correct': is_correct,
                    'explanation': question['explanation']
                })
            
            score = (correct_count / len(quiz['questions'])) * 100
            
            return {
                'score': score,
                'correct_count': correct_count,
                'total_questions': len(quiz['questions']),
                'results': results,
                'passed': score >= 70  # 70점 이상 통과
            }
            
        except Exception as e:
            logger.error(f"퀴즈 채점 실패: {e}")
            return {'error': '퀴즈 채점 중 오류가 발생했습니다.'}
```

### 3. 학습 진도 추적
```python
# web/services/progress_service.py
class ProgressService:
    def __init__(self):
        self.db = DatabaseService()
    
    def track_learning_activity(self, user_id: str, activity: Dict[str, Any]):
        """학습 활동 추적"""
        try:
            activity_data = {
                'user_id': user_id,
                'activity_type': activity['type'],
                'module_id': activity.get('module_id'),
                'lesson_id': activity.get('lesson_id'),
                'duration': activity.get('duration', 0),
                'timestamp': datetime.now().isoformat()
            }
            
            self.db.save_learning_activity(activity_data)
            
            # 실시간 진도 업데이트
            self.update_progress_cache(user_id)
            
        except Exception as e:
            logger.error(f"학습 활동 추적 실패: {e}")
    
    def get_learning_analytics(self, user_id: str) -> Dict[str, Any]:
        """학습 분석 데이터"""
        try:
            activities = self.db.get_user_activities(user_id)
            
            # 학습 시간 분석
            total_time = sum(a['duration'] for a in activities)
            daily_time = self.calculate_daily_learning_time(activities)
            
            # 강의별 완료율
            lesson_completion = self.calculate_lesson_completion(activities)
            
            # 퀴즈 성적 분석
            quiz_performance = self.analyze_quiz_performance(user_id)
            
            return {
                'total_learning_time': total_time,
                'daily_average_time': daily_time,
                'lesson_completion': lesson_completion,
                'quiz_performance': quiz_performance,
                'learning_streak': self.calculate_learning_streak(activities),
                'recommended_next_lesson': self.recommend_next_lesson(user_id)
            }
            
        except Exception as e:
            logger.error(f"학습 분석 조회 실패: {e}")
            return {}
    
    def calculate_learning_streak(self, activities: List[Dict[str, Any]]) -> int:
        """연속 학습 일수 계산"""
        if not activities:
            return 0
        
        # 날짜별 학습 활동 그룹화
        daily_activities = {}
        for activity in activities:
            date = activity['timestamp'].split('T')[0]
            if date not in daily_activities:
                daily_activities[date] = []
            daily_activities[date].append(activity)
        
        # 연속 일수 계산
        dates = sorted(daily_activities.keys(), reverse=True)
        streak = 0
        current_date = datetime.now().date()
        
        for date_str in dates:
            date = datetime.strptime(date_str, '%Y-%m-%d').date()
            if (current_date - date).days == streak:
                streak += 1
            else:
                break
        
        return streak
```

## 📊 데이터베이스 구조

### 학습 관련 테이블
```sql
CREATE TABLE learning_modules (
    id SERIAL PRIMARY KEY,
    title VARCHAR(200) NOT NULL,
    description TEXT,
    level VARCHAR(20) NOT NULL,
    duration INTEGER NOT NULL,
    order_index INTEGER NOT NULL,
    is_active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE learning_lessons (
    id SERIAL PRIMARY KEY,
    module_id INTEGER REFERENCES learning_modules(id),
    title VARCHAR(200) NOT NULL,
    content TEXT NOT NULL,
    duration INTEGER NOT NULL,
    order_index INTEGER NOT NULL,
    quiz_id INTEGER,
    is_active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE user_learning_progress (
    id SERIAL PRIMARY KEY,
    user_id VARCHAR(50) NOT NULL,
    module_id INTEGER REFERENCES learning_modules(id),
    lesson_id INTEGER REFERENCES learning_lessons(id),
    completed BOOLEAN DEFAULT FALSE,
    completion_date TIMESTAMP,
    learning_time INTEGER DEFAULT 0,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE quiz_questions (
    id SERIAL PRIMARY KEY,
    quiz_id INTEGER NOT NULL,
    question_text TEXT NOT NULL,
    options JSONB NOT NULL,
    correct_answer INTEGER NOT NULL,
    explanation TEXT,
    order_index INTEGER NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE user_quiz_results (
    id SERIAL PRIMARY KEY,
    user_id VARCHAR(50) NOT NULL,
    quiz_id INTEGER NOT NULL,
    score DECIMAL(5,2) NOT NULL,
    answers JSONB NOT NULL,
    completed_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

## 🎨 학습 콘텐츠 시각화

### 카드뉴스 시스템
```javascript
// web/static/js/learning-cardnews.js
class CardNewsManager {
    constructor() {
        this.currentSlide = 0;
        this.totalSlides = 0;
        this.init();
    }
    
    init() {
        this.loadCardNews();
        this.setupNavigation();
    }
    
    loadCardNews() {
        const cardNewsData = this.getCardNewsData();
        this.totalSlides = cardNewsData.slides.length;
        this.renderCardNews(cardNewsData);
    }
    
    renderCardNews(data) {
        const container = document.getElementById('cardnews-container');
        container.innerHTML = `
            <div class="cardnews-wrapper">
                <div class="cardnews-slides">
                    ${data.slides.map((slide, index) => `
                        <div class="cardnews-slide ${index === 0 ? 'active' : ''}" data-slide="${index}">
                            <div class="slide-image">
                                <img src="${slide.image}" alt="${slide.title}">
                            </div>
                            <div class="slide-content">
                                <h3>${slide.title}</h3>
                                <p>${slide.description}</p>
                                ${slide.highlight ? `<div class="highlight">${slide.highlight}</div>` : ''}
                            </div>
                        </div>
                    `).join('')}
                </div>
                
                <div class="cardnews-navigation">
                    <button class="nav-btn prev" onclick="cardNewsManager.previousSlide()">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <div class="slide-indicators">
                        ${data.slides.map((_, index) => `
                            <span class="indicator ${index === 0 ? 'active' : ''}" onclick="cardNewsManager.goToSlide(${index})"></span>
                        `).join('')}
                    </div>
                    <button class="nav-btn next" onclick="cardNewsManager.nextSlide()">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
            </div>
        `;
    }
    
    nextSlide() {
        if (this.currentSlide < this.totalSlides - 1) {
            this.currentSlide++;
            this.updateSlide();
        }
    }
    
    previousSlide() {
        if (this.currentSlide > 0) {
            this.currentSlide--;
            this.updateSlide();
        }
    }
    
    goToSlide(slideIndex) {
        this.currentSlide = slideIndex;
        this.updateSlide();
    }
    
    updateSlide() {
        // 모든 슬라이드 비활성화
        document.querySelectorAll('.cardnews-slide').forEach(slide => {
            slide.classList.remove('active');
        });
        
        // 모든 인디케이터 비활성화
        document.querySelectorAll('.indicator').forEach(indicator => {
            indicator.classList.remove('active');
        });
        
        // 현재 슬라이드 활성화
        const currentSlide = document.querySelector(`[data-slide="${this.currentSlide}"]`);
        const currentIndicator = document.querySelectorAll('.indicator')[this.currentSlide];
        
        if (currentSlide) currentSlide.classList.add('active');
        if (currentIndicator) currentIndicator.classList.add('active');
    }
}
```

## 🔐 학습 데이터 보안

### 콘텐츠 보호
```python
# web/services/content_protection_service.py
class ContentProtectionService:
    def __init__(self):
        self.watermark_key = os.environ.get('WATERMARK_KEY')
    
    def add_watermark(self, content: str, user_id: str) -> str:
        """콘텐츠에 워터마크 추가"""
        watermark = self.generate_watermark(user_id)
        return f"{content}\n\n--- Pixie Learning Platform ---\nUser: {watermark}"
    
    def generate_watermark(self, user_id: str) -> str:
        """사용자별 워터마크 생성"""
        import hashlib
        timestamp = datetime.now().strftime('%Y%m%d')
        return hashlib.md5(f"{user_id}{timestamp}{self.watermark_key}".encode()).hexdigest()[:8]
    
    def validate_content_access(self, user_id: str, content_id: int) -> bool:
        """콘텐츠 접근 권한 검증"""
        # 사용자의 학습 진도 확인
        user_progress = self.get_user_progress(user_id)
        
        # 이전 강의 완료 여부 확인
        required_lessons = self.get_required_lessons(content_id)
        
        for lesson_id in required_lessons:
            if not self.is_lesson_completed(user_id, lesson_id):
                return False
        
        return True
```

## 📈 성능 최적화

### 콘텐츠 캐싱
```python
# web/services/learning_cache_service.py
class LearningCacheService:
    def __init__(self):
        self.redis_client = redis.Redis(host='localhost', port=6379, db=0)
    
    def cache_learning_content(self, content_id: int, content: Dict[str, Any]):
        """학습 콘텐츠 캐싱"""
        cache_key = f"learning_content:{content_id}"
        self.redis_client.setex(cache_key, 3600, json.dumps(content))  # 1시간
    
    def get_cached_content(self, content_id: int) -> Optional[Dict[str, Any]]:
        """캐시된 콘텐츠 조회"""
        cache_key = f"learning_content:{content_id}"
        cached_data = self.redis_client.get(cache_key)
        return json.loads(cached_data) if cached_data else None
    
    def cache_user_progress(self, user_id: str, progress: Dict[str, Any]):
        """사용자 진도 캐싱"""
        cache_key = f"user_progress:{user_id}"
        self.redis_client.setex(cache_key, 1800, json.dumps(progress))  # 30분
```

## 🧪 테스트 전략

### 단위 테스트
```python
# tests/test_learning_service.py
import pytest
from web.services.learning_service import LearningService

class TestLearningService:
    def test_load_learning_modules(self):
        """학습 모듈 로드 테스트"""
        service = LearningService()
        modules = service.load_learning_modules()
        
        assert len(modules) > 0
        assert all('id' in module for module in modules)
        assert all('title' in module for module in modules)
        assert all('lessons' in module for module in modules)
    
    def test_get_user_progress(self):
        """사용자 진도 조회 테스트"""
        service = LearningService()
        user_id = "test_user_123"
        
        progress = service.get_user_progress(user_id)
        
        assert 'modules' in progress
        assert 'overall_progress' in progress
        assert isinstance(progress['overall_progress'], (int, float))
```

## 🚀 배포 및 운영

### 환경 설정
```python
# web/config/learning_config.py
class LearningConfig:
    # 학습 설정
    MAX_DAILY_LEARNING_TIME = 480  # 8시간
    MIN_QUIZ_PASS_SCORE = 70
    LEARNING_STREAK_THRESHOLD = 7  # 7일 연속
    
    # 콘텐츠 설정
    CONTENT_CACHE_TTL = 3600  # 1시간
    PROGRESS_CACHE_TTL = 1800  # 30분
    
    # 보안 설정
    WATERMARK_KEY = os.environ.get('WATERMARK_KEY')
    CONTENT_ENCRYPTION_KEY = os.environ.get('CONTENT_ENCRYPTION_KEY')
```

## 📊 분석 및 개선

### 학습 효과 분석
```python
# web/services/learning_analytics_service.py
class LearningAnalyticsService:
    def analyze_learning_effectiveness(self) -> Dict[str, Any]:
        """학습 효과 분석"""
        return {
            'completion_rates': self.get_completion_rates(),
            'quiz_performance': self.get_quiz_performance_stats(),
            'learning_time_analysis': self.analyze_learning_time(),
            'user_engagement': self.calculate_user_engagement(),
            'content_effectiveness': self.analyze_content_effectiveness()
        }
    
    def get_completion_rates(self) -> Dict[str, float]:
        """모듈별 완료율"""
        completion_data = self.query_completion_data()
        
        rates = {}
        for module in completion_data:
            module_id = module['module_id']
            total_users = module['total_users']
            completed_users = module['completed_users']
            rates[module_id] = (completed_users / total_users) * 100 if total_users > 0 else 0
        
        return rates
```

## 🔄 향후 개선 계획

### 단기 개선사항 (1-2개월)
1. **AI 기반 학습 경로** 최적화
2. **실시간 튜터링** 시스템
3. **모바일 앱** 학습 기능
4. **소셜 학습** 기능

### 중기 개선사항 (3-6개월)
1. **VR/AR 학습** 환경
2. **음성 기반** 학습
3. **개인화된 콘텐츠** 생성
4. **실전 시뮬레이션** 시스템

### 장기 개선사항 (6개월 이상)
1. **블록체인 기반** 학습 인증
2. **AI 튜터** 시스템
3. **글로벌 학습** 플랫폼
4. **실시간 협업** 학습

## 📚 참고 자료

### 기술 스택
- **프론트엔드**: HTML5, CSS3, JavaScript (ES6+)
- **백엔드**: Python Flask
- **데이터베이스**: PostgreSQL, Redis
- **차트**: Chart.js, D3.js
- **애니메이션**: CSS3, GSAP

### 라이브러리 및 도구
- **UI 프레임워크**: Bootstrap 5
- **이미지 처리**: Pillow
- **PDF 생성**: ReportLab
- **테스트**: pytest, Selenium
- **모니터링**: Prometheus, Grafana

이 문서는 Pixie 투자챗봇의 학습 시스템 개발 과정과 기술적 세부사항을 상세히 다루고 있습니다. 지속적인 콘텐츠 업데이트와 사용자 경험 개선을 통해 효과적인 투자 교육을 제공하는 것이 목표입니다. 